Content-type: text/html

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of BOOT</TITLE>
</HEAD><BODY>
<H1>BOOT</H1>
Section: Manuel de l'administrateur Linux (7)<BR>Updated: 25 juillet 2003<BR><A HREF="#index">Index</A>
<A HREF="/cgi-bin/man/man2html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NOM</H2>

<P>

boot-scripts - Description générale du démarrage du système.
<A NAME="lbAC">&nbsp;</A>
<H2>DESCRIPTION</H2>

<P>

La séquence de démarrage est variable en fonction du système
mais peut globalement être découpée selon les étapes suivantes&nbsp;:
(i) amorçage matériel, (ii) chargeur de démarrage,
(iii) démarrage du noyau, (iv) <B>init</B> et <B>inittab</B>,
(v) scripts de démarrage.
Nous allons décrire chacune d'entre-elles plus en détail ci-dessous.
<P>
<A NAME="lbAD">&nbsp;</A>
<H3>Amorçage matériel</H3>

Après la mise sous tension ou un reset matériel,
un programme stocké en mémoire morte (souvent une PROM) prend le contrôle.
Sur les PC, on appelle généralement ce programme le
<B>BIOS</B>.
<P>
Ce programme effectue normalement un auto-test de la machine
et accède à la mémoire non volatile pour y lire quelques paramètres.
Dans les PC, cette mémoire est maintenue par une batterie de type CMOS.
Ainsi la plupart des gens l'appellent <B>CMOS</B>, alors qu'en dehors
du monde des PC, elle
est généralement appelée <B>nvram</B>
(non-volatile ram).
<P>
Les paramètres stockés dans la <B>nvram</B> varient d'un système
à l'autre, mais au minimum, le programme d'amorçage matériel
devrait savoir quel est le périphérique d'amorçage, où à défaut
quels périphériques il faut essayer pour amorcer le système.
<P>
Ensuite, la phase de démarrage matériel accède au périphérique d'amorçage,
charge le chargeur de démarrage, qui est situé à une position
fixe sur le périphérique d'amorçage, et lui passe contrôle.
<P>
<DL COMPACT>
<DT>Note&nbsp;:<DD>
Nous n'abordons pas ici le démarrage à partir du réseau.
Ceux qui s'intéressent à ce sujet devraient rechercher du côté de
DHCP, TFTP, PXE, Etherboot, et nous rejoindre au <B>démarrage du noyau</B>.
<P>
</DL>
<A NAME="lbAE">&nbsp;</A>
<H3>Chargeur de démarrage</H3>

Sur les PC, le chargeur de démarrage est situé sur le premier
secteur du périphérique d'amorçage - c'est le <B>MBR</B>
(Master Boot Record).
<P>
Sur la plupart des systèmes, ce chargeur initial est très limité du fait de
diverses contraintes. Même sur des systèmes autres que le PC, il existe des
limitations concernant la taille et la complexité de ce chargeur, mais la taille
du MBR des PC  est limitée - 512 octets y compris la table de partition (64 octets)
et un identifiant de disque (2 octets) ne laissent que 446 octets pour le code - et
rend quasiment impossible le stockage d'un chargeur de démarrage complet.
<P>
Ainsi, sur la plupart des systèmes d'exploitation, le chargeur
initial appelle un chargeur de démarrage secondaire situé sur
une partition du disque.
<P>
Sous Linux, le chargeur de démarrage est normalement
<B><A HREF="/cgi-bin/man/man2html?8+lilo">lilo</A></B>(8)

ou
<B><A HREF="/cgi-bin/man/man2html?8+grub">grub</A></B>(8).

Chacun peut être installé soit en tant que chargeur secondaire
(si le MBR installé par DOS pointe vers eux), soit
en tant que chargeur en deux parties, car ils fournissent un
MBR spécial contenant un code d'amorçage pour charger
la seconde partie du chargeur à partir de la partition principale.
<P>
Le rôle principal du chargeur de démarrage est de localiser le
noyau sur le disque, le charger et l'exécuter.
La plupart des chargeurs de démarrage sont interactifs, pour
permettre la spécification d'un noyau alternatif (par exemple
un noyau de sauvegarde dans le cas où la dernière version compilée
ne fonctionne pas) et le passage de paramètres optionnels au noyau.
<P>
<A NAME="lbAF">&nbsp;</A>
<H3>Démarrage du noyau</H3>

Quand le noyau est chargé, il initialise les périphériques (via leurs pilotes), 
démarre le gestionnaire de swap (c'est un &quot;processus noyau&quot;,
appelé <B>kswapd</B> sur les noyaux Linux modernes), et monte le système
de fichiers racine - appelé <B>root filesystem</B> - (/).
<P>
Quelques paramètres relatifs à cela peuvent être passés au noyau
(par exemple : on peut spécifier un autre système de fichiers racine
que celui par défaut). Pour plus d'informations sur les paramètres
du noyau Linux, voir
<B><A HREF="/cgi-bin/man/man2html?7+bootparam">bootparam</A></B>(7).

<P>
C'est uniquement à cet instant que le noyau crée un premier
(en espace utilisateur) processus, qui porte le numéro 1.
Ce processus exécute le programme
<I>/sbin/init</I>,

en lui passant tout paramètre qui n'est pas déjà géré par le noyau.
<P>
<A NAME="lbAG">&nbsp;</A>
<H3>init et inittab</H3>

Quand init démarre, il lit
<I>/etc/inittab</I>

pour y trouver ses instructions. Ce fichier définit ce qui doit s'exécuter
dans les différents modes de fonctionnement (<I>run-levels</I>).
<P>
Cela donne à l'administrateur système une méthode simple de gestion dans laquelle
chaque run-level est associé à un ensemble de services (par exemple : <B>S</B>
correspond à un mode maintenance (<I>single-user</I>), en run-level <B>2</B>,
la plupart des services réseaux sont actifs, etc.). L'administrateur peut changer
le run-level courant par
<B><A HREF="/cgi-bin/man/man2html?8+init">init</A></B>(8)

et connaitre le run-level courant par
<B><A HREF="/cgi-bin/man/man2html?8+runlevel">runlevel</A></B>(8).

<P>
Toutefois, comme il n'est pas pratique de gérer les services
individuellement en éditant ce fichier, inittab se limite à
l'appel d'un ensemble de scripts qui démarrent/arrêtent les services.
<P>
<A NAME="lbAH">&nbsp;</A>
<H3>Scripts de démarrage</H3>

<P>
<DL COMPACT>
<DT>Note&nbsp;:<DD>
La description suivante s'applique aux systèmes basés sur SYSV-R4, qui couvre
actuellement la plupart des Unices commerciaux (Solaris, HPUX, Irix, Tru64) ainsi
que les distributions majeures de Linux (RedHat, Debian, Mandrake, Suse, Caldera).
Quelques systèmes (Slackware Linux, Gentoo Linux, FreeBSD, OpenBSD) utilisent un
procédé quelque peu différent pour les scripts de démarrage.
</DL>
<P>

<P>
Pour chaque service géré (messagerie, nfs, cron, etc.) il y a un script de
démarrage simple stocké dans un répertoire spécifique
(<I>/etc/init.d</I>

dans la majorité des versions de Linux).
Chacun de ces scripts accepte en unique argument le mot 


accepter d'autres paramètres pratiques (par exemple : 'restart', enchaine un

sans argument permet d'afficher tous ceux possibles. 
<P>
<A NAME="lbAI">&nbsp;</A>
<H3>Répertoires d'ordonnancement</H3>

Pour permettre aux scripts spécifiques de démarrer/arrêter un run-level
spécifique et dans un ordre particulier, il y a des <B>répertoires
d'ordonnancement</B>. Ce sont généralement <B>/etc/rc[0-6S].d</B>.
Dans chacun de ces répertoires, il y a des liens (généralement symboliques)
vers les scripts du répertoire <B>/etc/init.d</B>.
<P>
Un premier script (souvent <I>/etc/rc</I>) est appelé par <A HREF="/cgi-bin/man/man2html?5+inittab">inittab</A>(5) et appelle
lui-même les scripts des services grâce aux liens des répertoires
d'ordonnancement.
Tous les liens dont le nom commence par 'S' sont appelé avec l'argument 'start'
(et démarrent le service concerné). Tous les liens dont le nom commence par

<P>
Pour introduire un ordonnancement au sein d'un run-level, les noms des liens
contiennent des numéros d'ordre. Aussi, pour plus de clarté, ils se terminent
par le nom du service qu'ils concernent. Exemple&nbsp;: Le lien
<I>/etc/rc2.d/S80sendmail</I> démarre le service sendmail dans le run-level 2.
Cela est fait après l'exécution de <I>/etc/rc2.d/S12syslog</I> mais avant celle
de <I>/etc/rc2.d/S90xfs</I>.
<P>
<DL COMPACT>
<DT>Si l'on lit le script <I>/etc/rc</I>, on constate ce qui suit&nbsp;:<DD>
En premier lieu, les scripts K* sont exécutés pour arrêter les services
non concernés par le run-level, suivis des scripts S* pour démarrer ceux
qui le deviennent.
L'ordre est exactement celui du caractère d'expansion '*', car l'appel
successif des différents scripts se fait par une boucle 'for'. Pour
schématiser, <B>rc</B> exécute 'for i in /etc/rc$runlevel.d/K*; do $i stop ; done'
puis ensuite 'for i in /etc/rc.$runlevel.d/S*; do $i start ; done'.
</DL>
<P>

<P>
Pour gérer l'ordre de démarrage et les run-levels, on doit gérer ces liens.
Toutefois, sur beaucoup de versions de Linux, il existe des outils qui
facilitent cela. (exemple&nbsp;:
<B><A HREF="/cgi-bin/man/man2html?8+chkconfig">chkconfig</A></B>(8)).

<P>
<A NAME="lbAJ">&nbsp;</A>
<H3>Configuration de démarrage</H3>

Habituellement, les daemons démarrés peuvent éventuellement recevoir
des options et arguments sur leur ligne de commande. 
Pour permettre aux administrateurs systèmes de changer ces paramètres 
sans éditer le script, des fichiers de configuration sont utilisés.
Ils sont stockés dans un répertoire spécifique (<I>/etc/sysconfig</I> sur les
systèmes RedHat et Mandrake), et sont utilisés par les scripts de démarrage.
<P>
Sur les anciens Unices, ces fichiers contenaient les options de ligne de commande
pour les daemons, mais sur les systèmes Linux modernes (et aussi sur HPUX), ces
fichiers contiennent uniquement des variables shell. Les scripts de démarrage du
répertoire <I>/etc/init.d</I> <B>sourcent</B> (par la commande interne '<B>.</B>' du
shell) les fichiers de configuration et utilisent ensuite les variables.
<A NAME="lbAK">&nbsp;</A>
<H2>FICHIERS</H2>

<P>

<I>/etc/init.d/</I>,

<I>/etc/rc[S0-6].d/</I>.

<I>/etc/sysconfig/</I>

<P>
<A NAME="lbAL">&nbsp;</A>
<H2>VOIR AUSSI</H2>

<B><A HREF="/cgi-bin/man/man2html?5+inittab">inittab</A></B>(5),

<B><A HREF="/cgi-bin/man/man2html?7+bootparam">bootparam</A></B>(7),

<B><A HREF="/cgi-bin/man/man2html?8+init">init</A></B>(8),

<B><A HREF="/cgi-bin/man/man2html?8+runlevel">runlevel</A></B>(8),

<B><A HREF="/cgi-bin/man/man2html?8+shutdown">shutdown</A></B>(8)

<A NAME="lbAM">&nbsp;</A>
<H2>TRADUCTION</H2>

François Micaux, 2003.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NOM</A><DD>
<DT><A HREF="#lbAC">DESCRIPTION</A><DD>
<DL>
<DT><A HREF="#lbAD">Amorçage matériel</A><DD>
<DT><A HREF="#lbAE">Chargeur de démarrage</A><DD>
<DT><A HREF="#lbAF">Démarrage du noyau</A><DD>
<DT><A HREF="#lbAG">init et inittab</A><DD>
<DT><A HREF="#lbAH">Scripts de démarrage</A><DD>
<DT><A HREF="#lbAI">Répertoires d'ordonnancement</A><DD>
<DT><A HREF="#lbAJ">Configuration de démarrage</A><DD>
</DL>
<DT><A HREF="#lbAK">FICHIERS</A><DD>
<DT><A HREF="#lbAL">VOIR AUSSI</A><DD>
<DT><A HREF="#lbAM">TRADUCTION</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 14:55:58 GMT, February 11, 2014
</BODY>
</HTML>
