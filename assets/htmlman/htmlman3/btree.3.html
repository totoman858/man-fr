Content-type: text/html

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of BTREE</TITLE>
</HEAD><BODY>
<H1>BTREE</H1>
Section: Manuel du programmeur Linux (3)<BR>Updated: 21 juillet 2003<BR><A HREF="#index">Index</A>
<A HREF="/cgi-bin/man/man2html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NOM</H2>

btree - Méthodes d'accès à une base de données en arbre binaire.
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<PRE>
<B>#include &lt;<A HREF="file:///usr/include/sys/types.h">sys/types.h</A>&gt;
#include &lt;<A HREF="file:///usr/include/db.h">db.h</A>&gt;
</B></PRE>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

La routine
<I>dbopen</I>

est l'interface de bibliothèque pour les fichiers de base de données.
L'un des formats de fichier supportés est le type des arbres binaires.
La description générale des méthodes d'accès à une base de données
est fournie dans la page de manuel
<I><A HREF="/cgi-bin/man/man2html?3+dbopen">dbopen</A></I>(3).

La page présente ne décrit que les informations spécifiques aux arbres
binaires.
<P>

Une telle structure de données est un arbre équilibré, trié, mémorisant
les paires clés-données associées. 
<P>

La structure de données spécifique aux méthodes d'accès aux arbres binaires,
et que l'on transmet à
<I>dbopen</I>

est définie dans le fichier d'en-tête &lt;<A HREF="file:///usr/include/db.h">db.h</A>&gt; ainsi :
<P>

typedef struct {
<DL COMPACT><DT><DD>
u_long flags;
<BR>

u_int cachesize;
<BR>

int maxkeypage;
<BR>

int minkeypage;
<BR>

u_int psize;
<BR>

int (*compare)(const DBT *key1, const DBT *key2);
<BR>

size_t (*prefix)(const DBT *key1, const DBT *key2);
<BR>

int lorder;
</DL>

} BTREEINFO;
<P>

Les éléments de cette structures sont les suivants :
<DL COMPACT>
<DT>flags<DD>
Cet attribut est rempli avec un OU binaire entre les valeurs suivantes :
<DL COMPACT><DT><DD>
<DL COMPACT>
<DT>R_DUP<DD>
Autoriser les clés dupliquées dans l'arbre, c'est à dire, permettre l'insertion
même si la clé existe déjà dans l'arbre.
Le comportement par défaut, comme décrit dans
<I><A HREF="/cgi-bin/man/man2html?3+dbopen">dbopen</A></I>(3),

est d'écraser la clé existante ou d'échouer si la valeur d'attribut
R_NOOVERWRITE est indiquée.
L'attribut R_NOOVERWRITE a priorité sur R_DUP, et une tentative d'insertion
de clé déjà existante échouera s'ils sont tous les deux mentionnés.
<DT><DD>
Si la base de données contient des clés dupliquées, l'ordre de
récupération des paires clé-valeur est indéfini si l'on utilise
la routine
<I>get</I>.

Toutefois la routine
<I>seq</I>

avec l'attribut R_CURSOR positionné renvoie la clé &quot;logiquement première&quot;
de chaque groupe de clés dupliquées. 
</DL>
</DL>

<DT>cachesize<DD>
Une suggestion de taille maximale (en octets) du cache mémoire.
Cette valeur est
<B>seulement</B>

indicative, et les méthodes d'accès alloueront plus de mémoire plutôt que
d'échouer.
Comme chaque recherche examine la page racine de l'arbre, le cache des
pages les plus récemment consultées améliore les temps d'accès.
De plus, les écritures physiques sont retardées aussi longtemps que possible,
ainsi un cache, même modeste, peut améliorer sensiblement les opérations
d'entrée/sortie. Bien sûr l'utilisation d'un cache augmente la probabilité
(jamais nulle toutefois) de corruption ou de perte de données si le
système se plante alors qu'un arbre est en cours de modification.
Si 
<I>cachesize</I>

vaut 0 (pas de taille indiquée) on utilise un cache par défaut.
<DT>maxkeypage<DD>
Le nombre maximum de clés qui seront stockées sur une seule page.
Pas encore implémenté.
<DT>minkeypage<DD>
Le nombre minimum de clés qui seront stockées sur la même page. Cette valeur
sert à déterminer quelles clés seront stockées sur des pages de débordement.
Lorsqu'un clé ou une donnée est plus grande que la taille de page divisée
par le nombre minimum de clés, elle est stockée sur des pages de
débordement plutôt que sur la page elle-même.
Si
<I>minkeypage</I>

est nulle (pas de nombre minimum de clés indiqué), on utilise la valeur 2.
<DT>psize<DD>
Taille (en octets) des pages utilisées pour les noeuds de l'arbre. La taille
minimale est 512 octets, et la taille maximale 64 K.
Si
<I>psize</I>

vaut 0, (pas de taille indiquée), la taille de page est choisie en fonction
de la taille des blocs d'entrée/sortie du système de fichiers sous-jacent.
<DT>compare<DD>
Fonction de comparaison de clé. Elle doit renvoyer un entier inférieur, égal
ou supérieur à zéro lorsque le premier argument est respectivement inférieur,
égal ou supérieur au second.
La même fonction de comparaison doit toujours être utilisé pour un arbre donné,
même lors de la réouverture ultérieure de la base de données.
Si
<I>compare</I>

vaut NULL (pas de fonction indiquée), les clés sont comparées de manière
lexicographique, les clés les plus courtes considérées comme inférieures aux
clés les plus longues.
<DT>prefix<DD>
Fonction de comparaison avec préfixe.
Si elle est fournie, cette routine doit renvoyer le nombre d'octets du second
argument clé qui sont nécessaires pour déterminer s'il est supérieur au
premier argument. Si les clés sont égales, on doit renvoyer la longueur de
la clé. Remarquez que l'utilité d'une telle routine dépend dans une très
large mesure du type de données manipulées, mais il arrive que cette routine
fournisse des réductions significatives de taille d'arbre et de temps de
recherche.
Si
<I>prefix</I>

vaut NULL (pas de fonction indiquée),
<B>et</B>

si aucune fonction de comparaison n'est mentionnée, une routine de comparaison
lexicographique est employée.
Si
<I>prefix</I>

est NULL mais si un routine de comparaison est founie, aucune comparaison
de préfixe n'est effectuée.
<DT>lorder<DD>
L'ordre des octets pour les entiers stockés dans la base de données.
Ce nombre doit représenter l'ordre sous forme d'entier. Par exemple l'ordre
poids faible-poids fort (big endian) est représenté par le nombre 4321.
Si
<I>lorder</I>

vaut 0 (pas d'ordre indiqué), on utilise l'ordre des octets du système hôte.
</DL>
<P>

Si le fichier existe déjà (et si le drapeau O_TRUNC) n'est pas spécifié),
les valeurs indiquées par les paramètres flags, lorder, et psize sont
ignorées, et remplacées par les valeurs fournies lors de la création
de l'arbre.
<P>

Le balayage séquentiel de l'arbre vers l'avant se déroule de la plus petite
clé vers la plus grande.
<P>

L'espace libéré par la destruction des paires clés/données n'est jamais
récupéré, bien qu'il soit théoriquement disponible pour être ré-utilisé. Ceci
signifie qu'une base de données en arbre binaire ne fait que grandir.
Il faut donc éviter les destructions exagérées, ou reconstruire régulièrement
un nouvel arbre en balayant systématiquement l'ancien.
<P>

Les recherches, les insertions et les suppressions dans un arbre binaire
s'effectuent en O lg base N, où base représente le facteur de remplissage
moyen.
Souvent, l'insertion de données déjà ordonnées dans un arbre binaire résulte
en un facteur d'insertion faible. Cette implémentation a été modifiée pour
rendre l'insertion d'éléments ordonnés encore plus profitable. Ceci
donne un facteur de remplissage de pages encore meilleur. 
<A NAME="lbAE">&nbsp;</A>
<H2>ERREURS</H2>

Les routines d'accès aux
<I>arbres binaires</I>

peuvent échouer et renvoyer dans
<I>errno</I>

le code de toutes les erreurs indiquées pour les routines de la bibliothèque
<I><A HREF="/cgi-bin/man/man2html?3+dbopen">dbopen</A></I>(3).

<A NAME="lbAF">&nbsp;</A>
<H2>VOIR AUSSI</H2>

<I><A HREF="/cgi-bin/man/man2html?3+dbopen">dbopen</A></I>(3),

<I><A HREF="/cgi-bin/man/man2html?3+hash">hash</A></I>(3),

<I><A HREF="/cgi-bin/man/man2html?3+mpool">mpool</A></I>(3),

<I><A HREF="/cgi-bin/man/man2html?3+recno">recno</A></I>(3)

<P>
<I>The Ubiquitous B-tree</I>,

Douglas Comer, ACM Comput. Surv. 11, 2 (June 1979), 121-138.
<P>
<I>Prefix B-trees</I>,

Bayer and Unterauer, ACM Transactions on Database Systems, Vol. 2, 1
(March 1977), 11-26.
<P>
<I>The Art of Computer Programming Vol. 3: Sorting and Searching</I>,

D.E. Knuth, 1968, pp 471-480.
<P>
<A NAME="lbAG">&nbsp;</A>
<H2>BOGUES</H2>

Seuls les ordres d'octets big-endian et little-endian fonctionnent.
<P>
<A NAME="lbAH">&nbsp;</A>
<H2>TRADUCTION</H2>

Christophe Blaess, 1999-2003.
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NOM</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">ERREURS</A><DD>
<DT><A HREF="#lbAF">VOIR AUSSI</A><DD>
<DT><A HREF="#lbAG">BOGUES</A><DD>
<DT><A HREF="#lbAH">TRADUCTION</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 14:55:32 GMT, February 11, 2014
</BODY>
</HTML>
