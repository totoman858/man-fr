Content-type: text/html

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of WAIT</TITLE>
</HEAD><BODY>
<H1>WAIT</H1>
Section: Manuel du programmeur Linux (2)<BR>Updated: 18 juillet 2003<BR><A HREF="#index">Index</A>
<A HREF="/cgi-bin/man/man2html">Return to Main Contents</A><HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NOM</H2>

wait, waitpid - Attendre la fin d'un processus.
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>#include &lt;<A HREF="file:///usr/include/sys/types.h">sys/types.h</A>&gt;</B>

<BR>

<B>#include &lt;<A HREF="file:///usr/include/sys/wait.h">sys/wait.h</A>&gt;</B>

<P>
<B>pid_t wait (int * </B><I>status</I><B>);</B>

<BR>

<B>pid_t waitpid (pid_t </B><I>pid</I><B>, int * </B><I>status</I><B>, int </B><I>options</I><B>);</B>

<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>

La fonction
<B>wait</B>

suspend l'exécution du processus courant jusqu'à ce qu'un enfant
se termine, ou jusqu'à ce qu'un signal à intercepter arrive.
Si un processus fils s'est déjà terminé au moment de l'appel
(il est devenu &quot;zombie&quot;), la fonction revient immédiatement.
Toutes les ressources utilisées par le fils sont libérées.
<P>
La fonction
<B>waitpid</B>

suspend l'exécution du processus courant jusqu'à ce que le 
processus fils numéro
<I>pid</I>

se termine, ou jusqu'à ce qu'un signal à intercepter arrive.
Si le fils mentionné par
<I>pid</I>

s'est déjà terminé au moment de l'appel
(il est devenu &quot;zombie&quot;), la fonction revient immédiatement.
Toutes les ressources utilisées par le fils sont libérées.
<P>
La valeur de
<I>pid</I>

peut également être l'une des suivantes :
<DL COMPACT>
<DT>&lt; -1<DD>
attendre la fin de n'importe quel processus fils
appartenant à un groupe de processus d'ID 
<I>pid</I>.

<DT>-1<DD>
attendre la fin de n'importe quel fils. C'est le même
comportement que
<B>wait.</B>

<DT>0<DD>
attendre la fin de n'importe quel processus fils du même groupe
que l'appelant.
<DT>&gt; 0<DD>
attendre la fin du processus numéro
<I>pid</I>.

</DL>
<P>

La valeur de l'argument option
<I>options</I>

est un 
<I>OU</I>

binaire entre les constantes suivantes :
<DL COMPACT>
<DT><B>WNOHANG</B>

<DD>
ne pas bloquer si aucun fils ne s'est terminé.
<DT><B>WUNTRACED</B>

<DD>
recevoir l'information concernant également les fils bloqués (mais non suivis par
<B><A HREF="/cgi-bin/man/man2html?2+trace">trace</A></B>(2))

si on ne l'a pas encore reçue. L'état des fils suivis est fourni même sans
cette option
</DL>
<P>

(Pour les options spécifiques à Linux, voir plus bas).
<P>

Si
<I>status</I>

est non
<B>NULL</B>,

<B>wait</B>

et
<B>waitpid</B>

y stockent l'information sur la terminaison du fils.
<P>
Cette information peut être analysée avec les macros suivantes,
qui réclament en argument le buffer
<I>status</I>

(un <B>int</B>, et non pas un pointeur sur ce buffer).
<DL COMPACT>
<DT><B>WIFEXITED(</B><I>status</I><B>)</B>

<DD>
non nul si le fils s'est terminé normalement
<DT><B>WEXITSTATUS(</B><I>status</I><B>)</B>

<DD>
donne le code de retour tel qu'il a été mentionné dans l'appel
<B>exit()</B>

ou dans le
<B>return</B>

de la routine
<B>main.</B>

Cette macro ne peut être évaluée que si 
<B>WIFEXITED</B>

est non nul.
<DT><B>WIFSIGNALED(</B><I>status</I><B>)</B>

<DD>
indique que le fils s'est terminé à cause d'un signal non
intercepté.
<DT><B>WTERMSIG(</B><I>status</I><B>)</B>

<DD>
donne le numéro du signal qui a causé la fin du fils. Cette
macro ne peut être évaluée que si
<B>WIFSIGNALED</B>

est non nul.
<DT><B>WIFSTOPPED(</B><I>status</I><B>)</B>

<DD>
indique que le fils est actuellement arrêté. Cette macro n'a de
sens que si l'on a effectué l'appel avec l'option
<B>WUNTRACED</B>.

<DT><B>WSTOPSIG(</B><I>status</I><B>)</B>

<DD>
donne le numéro du signal qui a causé l'arrêt du fils. Cette macro
ne peut être évaluée que si
<B>WIFSTOPPED</B>

est non nul.
</DL>
<P>

Certaines versions d'Unix (Linux, Solaris, mais pas AIX ou SunOS) définissent
aussi une macro
<B>WCOREDUMP(</B><I>status</I><B>)</B>

Pour vérifier si le processus fils a créé un fichier core. N'utilisez ceci
qu'encadré par #ifdef WCOREDUMP ... #endif.
<A NAME="lbAE">&nbsp;</A>
<H2>VALEUR RENVOYÉE</H2>

En cas de réussite, le PID du fils qui s'est terminé est renvoyé,
en cas d'échec -1 est renvoyé et
<I>errno</I>

contient le code d'erreur.
Si
<B>WNOHANG</B>

a été employé et qu'aucun fils ne s'est terminé, zéro est renvoyé.
<A NAME="lbAF">&nbsp;</A>
<H2>ERREURS</H2>

<DL COMPACT>
<DT><B>ECHILD</B>

<DD>
Le processus indiqué par
<I>pid</I>

n'existe pas, ou n'est pas un fils du processus appelant.
(Ceci peut arriver pour son propre fils si l'action de SIGCHLD est
placé sur SIG_IGN, voir également le passage de la section NOTES concernant les threads).
<DT><B>EINVAL</B>

<DD>
L'argument
<I>options</I>

est invalide.
<DT><B>EINTR</B>

<DD>
<B>WNOHANG</B>

n'est pas indiqué, et un signal à intercepter ou
<B>SIGCHLD</B>

a été reçu.
</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>NOTES</H2>

Les spécifications Single Unix décrivent un attribut SA_NOCLDWAIT
(non supportés sous Linux) permettant (lorsqu'il est positionné) aux
processus fils se terminant de ne pas devenir zombies, comme quand
l'action pour SIGCHLD est fixée à SIG_IGN. Un appel
à
<I>wait()</I>

ou
<I>waitpid()</I>

bloquera jusqu'à ce qu'un fils se termine, puis échouera avec
<I>errno</I>

contenant ECHILD.
<P>

Le standard POSIX original laissait le comportement avec SIGCHLD à
SIG_IGN non spécifié.
Les standards ultérieurs, y compris SUSv2 et POSIX 1003.1-2001 spécifent
que le comportement décrit ci-dessus est une option XSI.
Linux ne se conforme pas au second des deux points décrits&nbsp;:
Si un appel
<B>wait</B>() ou <B>waitpid</B>()

est fait alors que SIGCHLD est ignoré, alors l'appel se comportera comme
si SIGCHLD n'était pas ignoré, c'est à dire qu'il bloquera jusqu'à la
première fin d'un fils et renverra le PID et l'état du fils.
<P>
<A NAME="lbAH">&nbsp;</A>
<H2>SPÉCIFICITÉS LINUX</H2>

Dans le noyau Linux, un thread ordonnancé par le noyau n'est pas différent
d'un simple processus. En fait, un thread est juste un processus qui est créé
à l'aide de la routine - spécifique Linux - 
<B><A HREF="/cgi-bin/man/man2html?2+clone">clone</A></B>(2).

Les routines portables, comme
<B><A HREF="/cgi-bin/man/man2html?3+pthread_create">pthread_create</A></B>(3)

sont implémentées en appelant
<B><A HREF="/cgi-bin/man/man2html?2+clone">clone</A></B>(2).

Avant Linux 2.4, un thread était simplement un cas particulier de processus, et
en conséquence un thread ne pouvait pas attendre les enfants d'un autre thread,
même si ce dernier appartenait au même groupe de threads.
Toutefois, POSIX réclame une telle fonctionnalité, et depuis Linux 2.4
un thread peut, par défaut, attendre les enfants des autres threads
du même groupe.
<P>

Les 
<I>options</I>

suivantes sont spécifiques à Linux, et 
servent pour les enfants créés avec
<B><A HREF="/cgi-bin/man/man2html?2+clone">clone</A></B>(2).

<DL COMPACT>
<DT><B>__WCLONE</B>

<DD>

Attendre uniquement des enfants clones. Sinon, attendre uniquement les
enfants non-clones (un enfant &quot;clone&quot; est un enfant qui
n'envoie pas de signal, ou un autre signal que
<B>SIGCHLD</B>

à son père à sa terminaison).
Cette option est ignorée si
<B>__WALL</B>

est aussi indiqué.
<DT><B>__WALL</B>

<DD>

(Depuis Linux 2.4) Attendre tous les enfants, quelques soient leurs
types (clone ou non-clone).
<DT><B>__WNOTHREAD</B>

<DD>

(Depuis Linux 2.4) Ne pas attendre les enfants des autres threads du même
groupe de threads. Ceci était le cas par défaut avant Linux 2.4.
</DL>
<A NAME="lbAI">&nbsp;</A>
<H2>CONFORMITÉ</H2>

SVr4, POSIX.1
<A NAME="lbAJ">&nbsp;</A>
<H2>VOIR AUSSI</H2>

<B><A HREF="/cgi-bin/man/man2html?2+clone">clone</A></B>(2),

<B><A HREF="/cgi-bin/man/man2html?2+ptrace">ptrace</A></B>(2),

<B><A HREF="/cgi-bin/man/man2html?2+signal">signal</A></B>(2),

<B><A HREF="/cgi-bin/man/man2html?2+wait4">wait4</A></B>(2),

<B><A HREF="/cgi-bin/man/man2html?3+pthread_create">pthread_create</A></B>(3),

<B><A HREF="/cgi-bin/man/man2html?7+signal">signal</A></B>(7)

<A NAME="lbAK">&nbsp;</A>
<H2>TRADUCTION</H2>

Christophe Blaess, 1996-2003.

<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NOM</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">VALEUR RENVOYÉE</A><DD>
<DT><A HREF="#lbAF">ERREURS</A><DD>
<DT><A HREF="#lbAG">NOTES</A><DD>
<DT><A HREF="#lbAH">SPÉCIFICITÉS LINUX</A><DD>
<DT><A HREF="#lbAI">CONFORMITÉ</A><DD>
<DT><A HREF="#lbAJ">VOIR AUSSI</A><DD>
<DT><A HREF="#lbAK">TRADUCTION</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 14:55:03 GMT, February 11, 2014
</BODY>
</HTML>
